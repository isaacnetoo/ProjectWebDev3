<!DOCTYPE html>

<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Find & buy the best bet products in Canada online </title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./css/body.css">
    <link rel="stylesheet" href="./css/header.css">
    <link rel="stylesheet" href="./css/filter.css">
    <link rel="stylesheet" href="./css/productDisplay.css">
    <link rel="stylesheet" href="./css/footer.css">
    <link rel="stylesheet" href="./css/cart.css">
    <link rel="stylesheet" href="./css/imageslide.css">
    <link rel="stylesheet" href="./css/modal.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto:wght@400;500;700&display=swap"
        rel="stylesheet">


</head>

<body>

    <header>
        <div class="header-container">
            <div class="first-column">
                <div class="first-column-first-row">
                    <p>1-844-799-7387</p>

                    <a href="">
                        <img src="./img/facebook.png" alt="Facebook">
                    </a>

                    <a href="">
                        <img src="./img/twitter.png" alt="twitter">
                    </a>
                    <a href="">
                        <img src="./img/instagram.png" alt="ins">
                    </a>
                    <a href="">
                        <img src="./img/youtube.png" alt="youtube">
                    </a>
                </div>

                <div class="first-column-second-row">
                    <h2><a href="./index.html">PawPalsMarket Connection </a></h2>
                </div>

                <div class="first-column-third-row">

                    <a href="">Shop by Brand</a>

                    <a href="">Book a Consultation</a>

                </div>
            </div>

            <div class="second-column">
                <img src="./img/PawPalSmarket-logo.png" alt="website-logo" class="website-logo">

            </div>

            <div class="third-column">

                <button class="hamburger-menu" aria-label="Open menu">
                    <img src="./img/icons8-hamburger-menu-50.png" alt="Menu" id="BurgerMenu">
                </button>
                <div class="third-column-first-row">
                    <a href="./index.html">Home</a>
                    <a href="">About Us</a>
                    <a href="">Login</a>
                    <a href="">MyPetCart</a>
                    <div class="cart-widget">
                        <img src="./img/icons8-add-shopping-cart-50.png" alt="Cart Icon">
                        <span class="cart-count">0</span> <!-- Assuming there are 3 items in the cart -->
                    </div>
                </div>



                <div class="search-container">
                    <input type="text" placeholder="What are you looking for today?" id="search-bar">
                    <ul id="suggestions"></ul>
                </div>

                <div class="third-column-third-row">

                    <a href="">New & Resources</a>

                    <a href="">Sales</a>

                </div>
            </div>
        </div>

        <div class="header-catergory-container">
            <div class="text-container">
                <a href="">Dog</a>
                <a href="">Cat</a>
                <a href="">Ferret</a>
                <a href="">Small Animal</a>
                <a href="">Reptile</a>
                <a href="">Bird</a>
                <a href="">Fish</a>
                <a href="">Farm</a>
                <a href="">People</a>
                <a href="">Gift Cards</a>
                <a href="">Best Sellers</a>
                <a href="">Bundles</a>
            </div>
        </div>
    </header>

    <div class="gallery-wrap">
        <img src="./img/3604564.png" id="BackBtn">
        <div class="gallery">
            <div class="gallery-container">
                <span><img src="./product_gallery/v-planet-mini-bites-kibbles.jpg"></span>
                <span><img src="./product_gallery/Carna4-Handcrafted-Chicken-Dog-Food-.png"></span>
                <span><img src="./product_gallery/Carna4-Handcrafted-Duck-Dog-Food-.png"></span>
            </div>
            <div class="gallery-container">
                <span><img src="./product_gallery/Companions-choice-probiotics-pets-pouch.png"></span>
                <span><img
                        src="./product_gallery/Farmina-Ancestral-Grain-Chicken-Pomegranate-Neutered-Adult-Cat-Food-PixTeller.png"></span>
                <span><img
                        src="./product_gallery/Farmina-Duck-Broccoli-Asparagus-Quinoa-Neutered-Adult-Cat-Food-PixTeller.png"></span>
            </div>
            <div class="gallery-container">
                <span><img src="product_gallery/Oxbow-garden-select-food-young-rabbit.png"></span>
                <span><img src="product_gallery/Oxbow-Organic-Bounty-Rabbit-Food-.png"></span>
                <span><img
                        src="product_gallery/SquarePet-VFS-PowerCat-Herring-Salmon-Cat-Food-11-lb-PixTeller.png"></span>
            </div>
            <div class="gallery-container">
                <span><img
                        src="./product_gallery/SquarePet-VFS-PowerCat-Turkey-Chicken-Cat-Food-11-lb-PixTeller.png"></span>
                <span><img src="./product_gallery/Stoter-Farm-Adult-Rabbit-Food11-.png"></span>
                <span><img
                        src="./product_gallery/The-New-Zealand-Natural-Pet-Food-Co-Meow-Venison-Air-Dried-Cat-Food-PixTeller.png"></span>
            </div>
        </div>
        <img src="./img/1723827.png" id="NextBtn">
    </div>


    <section class="customize-filter">
        <div class="filter-container">
            <div class="text-result-container">
                <h3>Found <strong id="productCounter"></strong> matching results for your search.</h3>
            </div>
            <div class="select-container">
                <select id="categoryFilter">
                    <option value="all">All&nbsp Products</option>
                    <option value="dogFood">Dog&nbsp Products</option>
                    <option value="catFood">Cat&nbsp Products</option>
                    <option value="rabbitFood">Rabbit&nbsp Products</option>
                    <option value="price">Sorted by Price </option>
                    <option value="rate">Sorted by Rate </option>
                </select>
                <div />
            </div>
    </section>




    <section class="product-display">
        <!-- <div class ="sorted">

        </div> -->
        <div class="product-display-container">

            <div class="product" id="ProductId">
                <img src="./product_gallery/v-planet-mini-bites-kibbles.jpg" alt="dogFood">
                <h4>V-planet Mini Bites Vegan Adult Dog Food by V-Dog</h4>
                <h3>Price:<span>38</span></h3>
                <h3>Rating: &nbsp<span>4.7</span></h3>
                <div class="CartButton-button-container">
                    <button class="CartButton">add to Cart</button>
                </div>
            </div>
        </div>

    </section>

    <div id="myModal" class="modal">
        <div class="modal-content">
            <span class="modalclose">&times;</span>
            <div class="modalbody">
                <img class="modalImg" id="imgm">
                <div id="caption"></div>
            </div>
        </div>
    </div>



    <div class="cartTab">
        <h1>Shopping Cart <img src="./img/icons8-add-shopping-cart-50.png" alt="Icon" style="width: 25px; height: 25px;"
                id="firstCartIcon"></h1>
        <div class="listCart">
            <!-- product display in cart template  -->
            <!-- <div class="item">
                <div class="image">
                    <img src="./product_gallery/v-planet-mini-bites-kibbles.jpg" alt="items">
                </div>
                <div class="name">
                    Farmina-Ancestral-Grain-Chicken-Pomegranate-Neutered-Adult-Cat-Food-PixTeller
                </div>
                <div class="itemPrice">
                    $38
                </div>
                <div class="amount">
                    <span class="minus">-</span>
                    <span class="itemAmount" >1</span>
                    <span class="plus">+</span>
                </div>

            </div> -->



        </div>
        <div class="totalPrice">
            <h4>You have added <span class="itemNumber">0</span> items to your Cart. <br>Total Price: <span
                    class="total-price"><span>0</span></h3>
        </div>
        <div class="btn">
            <button class="close">CLOSE CART</button>
            <button class="reset">RESET CART</button>
            <button class="check">CHECK OUT</button>
        </div>

    </div>




    <footer>
        <div class="footer-container">
            <div class="footer-text-container">
                <p>Â© 2024 PawPalsMarket Connection Inc. All Rights Reserved</p>
            </div>

            <div class="footer-image-container">
                <a href="">
                    <img src="./img/pet-community.jpg" alt="petcomunity">
                </a>
            </div>
            <div class="footer-image-container">
                <img src="./img/Pets-Canada-ENG-Logo-2.png.png" alt="pijac">
            </div>
        </div>
        <!-- move top button -->
        <button class="scrollToTopBtn" id="scrollToTopBtn">Top</button>
    </footer>


    <script type="module">
        import Cart from "./js/cartClass.js";
        import { productList, shoppingCartList } from './js/dataStore.js';
        import { handleCart } from './js/cart.js';

        // hamburger menu
        document.addEventListener("DOMContentLoaded", function () {
            const hamburgerMenu = document.querySelector('.hamburger-menu');
            const burgerImg = document.getElementById('BurgerMenu')
            // Use querySelectorAll to get all links you want to toggle
            const navLinks = document.querySelectorAll('.third-column-first-row a');

            hamburgerMenu.addEventListener('click', function () {
                // Loop through each link and toggle the class
                navLinks.forEach(link => {
                    link.classList.toggle('show-links');
                });

                if (burgerImg.getAttribute('src') === "./img/icons8-hamburger-menu-50.png") {
                    // If currently hamburger icon, change to close icon
                    burgerImg.src = "./img/icons8-close-50.png";
                } else {
                    // If currently close icon, change back to hamburger icon
                    burgerImg.src = "./img/icons8-hamburger-menu-50.png";
                }
            });


        });


        // const productList = new Map();  // already created the map in datastore.js
        // const shoppingCartList = new Map(); // already created the map in datastore.js



        // function to load product from json 
        const load = () => {
            const xHttp = new XMLHttpRequest();

            xHttp.onload = () => {
                // Parse the file data as JSON
                let tmpData = JSON.parse(xHttp.responseText);

                // Iterate over the data
                for (let data of tmpData) {
                    // Set key-value pairs in the productList map
                    productList.set(data.pid, data);

                }
                //literate the product list
                for (let value of productList.values()) {
                    console.log(value);

                    // After loading and populating productList, display the products
                    displayProduct(); // Call the function to display products
                }

            };
            xHttp.open("GET", "./data/mock.data.json"); // Open the request
            xHttp.send(); // Send the request
        }
        load();

        // search bar 
        const searchBar = document.getElementById('search-bar');

        searchBar.addEventListener('input', e => {
            // keep tracking user input 
            const inputValue = e.target.value.toLowerCase();
            // console.log(inputValue);
            displayProduct('all', inputValue)
        })

        const searchInput = document.getElementById("search-bar");
        const suggestionsList = document.getElementById("suggestions");

        const suggestions = [
            "Carna4-Handcrafted-Duck-Dog-Food",
            "Carna4-Handcrafted-Chicken-Dog-Food",
            "Companions-choice-probiotics-pets-pouch",
            "Farmina-Duck-Broccoli-Asparagus-Quinoa-Neutered-Adult-Cat-Food-PixTeller",
            "Farmina-Ancestral-Grain-Chicken-Pomegranate-Neutered-Adult-Cat-Food-",
            "Oxbow-Organic-Bounty-Rabbit-Food",
            "Oxbow-garden-select-food-young-rabbit",
            "SquarePet-VFS-PowerCat-Turkey-Chicken-Cat-Food-11-lb-PixTeller",
            "SquarePet-VFS-PowerCat-Herring-Salmon-Cat-Food-11-lb-PixTeller",
            "Stoter-Farm-Adult-Rabbit-Food11",
            "The-New-Zealand-Natural-Pet-Food-Co-Meow-Venison-Air-Dried-Cat-Food-PixTeller",
            "V-planet Mini Bites Vegan Adult Dog Food by V-Dog"
        ];

        function updateSuggestions() {
            const userInput = searchInput.value.trim().toLowerCase(); // Trim the user input to remove leading/trailing whitespace
            const filteredSuggestions = suggestions.filter(suggestion =>
                suggestion.toLowerCase().startsWith(userInput)
            );

            suggestionsList.innerHTML = "";

            if (userInput === "") {
                // Clear the suggestions list if user input is empty
                return;
            }

            filteredSuggestions.forEach(suggestion => {
                const li = document.createElement("li");
                li.textContent = suggestion;

                //add click event to suggestion list
                li.addEventListener('click', () => {
                    // Set the input field value to the suggestion text
                    searchInput.value = suggestion;

                    // Clear the suggestions list
                    suggestionsList.innerHTML = '';

                    // Call displayProduct to find the match product
                    displayProduct('all', suggestion.toLowerCase());


                });
                suggestionsList.appendChild(li);
            });


        }

        searchInput.addEventListener("input", updateSuggestions);

        function displaySelectedProduct(productName) {
            const productNameLowerCase = productName.toLowerCase();
            console.log("find product " + productName);

            displayProduct('all', productNameLowerCase); // Adjust according to your actual implementation

            // If necessary, clear the search input and suggestions list after selecting a product
            searchInput.value = '';
            suggestionsList.innerHTML = '';
        }

        // filter and product display based on user option 

        const categoryFilter = document.getElementById('categoryFilter');
        categoryFilter.addEventListener('change', e => {
            const selectedCategory = e.target.value; // Correctly get the selected option
            // console.log(selectedCategory); 
            displayProduct(selectedCategory); // Filter and display products
        });


        // default parameter is all 
        const displayProduct = (category = 'all', searchQuery = '') => {

            const productDisplayContainer = document.querySelector(".product-display-container");
            productDisplayContainer.innerHTML = '';

            const productNumCounter = document.getElementById("productCounter");
            productNumCounter.innerHTML = '';
            //initially convert productList map to an array for sorting and filtering
            let productsArray = Array.from(productList.values());

            //so now in this array, there are several product object, product.name = product name 
            // the way to iterate the products array 
            // for (let i = 0; i < productsArray.length; i++) {
            //     const product = productsArray[i];
            // }


            //logic sort by price from low to high
            if (category === 'price') {
                productsArray.sort((a, b) => a.price - b.price);

            }

            // logic sort by rating form high to low 
            if (category === 'rate') {
                productsArray.sort((a, b) => b.rating - a.rating);
            }

            //counter to display product result 
            let count = 0;
            console.log("this is searchQuery" + searchQuery);
            for (let product of productsArray) {
                // Matching the user input in the search bar to product name in lowercase 
                const matchSearchQuery = product.name.toLowerCase().includes(searchQuery);

                console.log("this is matchSearchQuery " + matchSearchQuery);
                //categroy =  dogFood or catFood or rabbitFood or price or rate / all = display all product
                if ((category === 'all' || product.category === category || category === 'price' || category === 'rate') && matchSearchQuery) {
                    count++;
                    const productElement = document.createElement("div");
                    productElement.classList.add("product"); // add class name product
                    productElement.id = product.pid; //set up id =pid 
                    //handle click event of add to cart 


                    productElement.innerHTML =
                        `<img src="${product.imagePath}" alt="${product.category}">
                        <h4>${product.name}</h4>
                        <h3>Price :&nbsp<span>${product.price}</span></h3>
                        <h3>Rating: <span>${product.rating}</span></h3>
                        <div class ="CartButton-button-container">
                            <button class="CartButton">Add to Cart</button>
                        </div>`;

                    // add products to html 

                    productDisplayContainer.append(productElement);
                }

            }
            // add product result to html 
            productNumCounter.append(count);

            // add click event to add to cart button 
            for (let addtoCart of document.querySelectorAll(".CartButton")) {

                addtoCart.addEventListener("click", handleCart);

            }
        }

        // js to implement slide animation feature 
        const scrollContainer = document.querySelector(".gallery");
        const slider = document.querySelector(".slider");
        const backBtn = document.getElementById("BackBtn");
        const nextBtn = document.getElementById("NextBtn");

        backBtn.addEventListener("click", () => {
            scrollContainer.scrollLeft -= slider.offsetWidth;
        });

        nextBtn.addEventListener("click", () => {
            scrollContainer.scrollLeft += slider.offsetWidth;
        });

        nextBtn.addEventListener("click", () => {
            scrollContainer.style.scrollBehavior = "smooth";
            //  Each slide is the full width of the container
            scrollContainer.scrollLeft += scrollContainer.offsetWidth;
        });

        backBtn.addEventListener("click", () => {
            scrollContainer.style.scrollBehavior = "smooth";
            // Each slide is the full width of the container
            scrollContainer.scrollLeft -= scrollContainer.offsetWidth;
        });

        // js to implement back to top feature 
        document.addEventListener("DOMContentLoaded", function () {
            var scrollToTopBtn = document.getElementById("scrollToTopBtn");
            var rootElement = document.documentElement;

            // When the user scrolls down the page, show the button
            window.addEventListener("scroll", function () {
                if (window.scrollY > 20) {
                    scrollToTopBtn.style.display = "block";
                } else {
                    scrollToTopBtn.style.display = "none";
                }
            });

            // When the user clicks on the button, scroll to the top of the document
            scrollToTopBtn.addEventListener("click", function () {
                scrollToTop();
            });

            // Function to smoothly scroll to the top of the document
            function scrollToTop() {
                // Scroll to top logic
                rootElement.scrollTo({
                    top: 0,
                    behavior: "smooth"
                });
            }
        });

        //modal
        document.addEventListener('DOMContentLoaded', function () {
            var modal = document.getElementById('myModal');
            var modalImg = document.getElementById('imgm');
            var caption = document.getElementById('caption');
            var span = document.getElementsByClassName('modalclose')[0];

            document.querySelector('.product-display-container').addEventListener('click', function (event) {
                if (event.target.classList.contains('CartButton')) {
                    // If the clicked element has the class 'CartButton', stop the function.
                    return;
                }

                var product = event.target.closest('.product');

                if (product) {
                    var imgSrc = product.querySelector("img").src;
                    var productName = product.querySelector("h4").textContent;
                    var price = product.querySelector("h3 span").textContent;

                    modal.style.display = "block";
                    modalImg.src = imgSrc;
                    caption.innerHTML = `${productName} <br><br>Price:  $${price}`; // Fixed typo from 'aption' to 'caption'
                }
            });

            span.onclick = function () {
                modal.style.display = "none";
            };

            window.onclick = function (e) {
                if (e.target == modal) {
                    modal.style.display = "none";
                }
            }
        });




    </script>
    <!-- external cart  js  -->
    <script type="module" src="./js/cart.js"></script>

</body>

</html>